<a id="registry"></a>
<h1>Registry</h1>
<div class="white-container">
    <p>
        <img ng-src="images/documentation/registry1.png" id="registry1png" class="image-border image-right img-margin-l-b"/>
        SOAJS offers the ability to have multiple projects running on different environments with different configuration. Projects are located in SOAJS under the <b>profiles</b> folder.<br />The name of the project is set using an <a href="http://en.wikipedia.org/wiki/Environment_variable" target="_blank">environment variable</a> on your machine or the project named <b>default</b> is used, the same applies on which environment will be loaded, and where to loacate the projects registry information.<br />SOAJS uses 3 environment variables to locate the project profile to use:
	    <ul>
			<li><b>SOAJS_REGDIR</b>: The path from the root level to where the profiles folder is located.</li>
			<li><b>SOAJS_PRJ</b>: The project folder inside the profiles folder that should be used.</li>
			<li><b>SOAJS_ENV</b>: The environment to load from the profiles folder.</li>
		</ul>
		By default, SOAJS looks for the profiles folder if the environment variable is not set in its root folder. This folder contains the project name, environments and all registry coniguration needed by SOAJS so that the application can run.<br />You can change the path of the profiles folder to another destination but keep in mind if you do that, you need to update the value of the environment value <b>SAOJS_REGDIR</b>.
		The same concept applies for project and environment names, by default, SOAJS uses the <b>default</b> project name in profiles folder and the <b>dev</b> environment. When you create a new project make sure you update <b>SOAJS_PRJ</b> and when you deploy on a new environment other than <b>dev</b>, also change <b>SOAJS_ENV</b>.<br /><br />
        Every Project can run in different environments. You define for each environment: the DB configuration, the templates, the services and their options. The default one is <b>dev</b>.
        <br/><br/>
        Projects also have templates and configuration files that are used inside the running environment. Configure your database connection and place your service templates in these
        designated areas.
        <br/><br/>
    </p>
    <hr/>
    <h3>Environment Registry Configuration</h3><br/>

    <p>
    <h4>1- General Registry Information</h4>

    <p>Create an environment and give it a name and a version<br/>
		<pre><code class="javascript">var registry ={
	"name": "dev",
	"version": "0.1",
	"environment":"develop",
	//...
}</code></pre>
    </p><br/><br/>

    <h4>2- Database Configuration</h4>

    <p>
	    Define the connection to the database for this environment; db name, prefix, server location, credentials â€¦ etc. (different environments can have different database connections)<br/>
        <pre><code class="javascript">"coreDB": {
	"dashboard": {
		"name": "core_dashboard",
		"prefix": dServers.prefix,
		"servers": dServers.servers,
		"credentials": dServers.credentials,
		"URLParam": dOptions.URLParam,
		"extraParam": dOptions.extraParam
	}
	//...
}</code></pre>
    </p><br/><br/>

    <a id="rest-apis"></a>
    <h4>3- REST APIs Configuration</h4>

    <p>Define the services by providing host, port, url and extKeyRequired.<br>
	<ul>
		<li>host: The host of the service</li>
		<li>port: The port that the service is listening on</li>
		<li>url: The url to access the service on this environment</li>
		<li>extKeyRequired:
		<ul>
			<li>when <b>extKeyRequired</b> is false: set it to false for services that are public and accessible without providing tenant keys.</li>
			<li>when <b>extKeyRequired</b> is  true: set it to true for services that are only accessible if a tenant key is provided in the request.</li>
		</ul>
		</li>
	</ul>
        <pre><code class="javascript">"services": {
    "controller": {
        "extKeyRequired": false,
	    "port": 4000,
	    "host": "rest-proxy",
	    "maxPoolSize": 100,
	    "requestTimeout": 30,
	    "requestTimeoutRenewal": 0,
	    "authorization": true
    },
    "urac": {
	    "extKeyRequired": true,
	    "port": 4001,
	    "host": "rest-proxy",
	    "url": "http://rest-proxy:4000/urac",
	    "mail": {
		    "join": "mail/urac/join.tmpl",
		    "forgotPassword": "mail/urac/forgotPassword.tmpl",
		    "addUser": "mail/urac/addUser.tmpl",
		    "changeUserStatus": "mail/urac/changeUserStatus.tmpl",
		    "changeEmail": "mail/urac/changeEmail.tmpl"
        }
    },
    "oauth": {
        "extKeyRequired": true,
	    "port": 4002,
	    "host": "rest-proxy",
	    "url": "http://rest-proxy:4000/oauth"
    },
    //...
    "example01": {
	    "extKeyRequired": false,
	    "port": 4010,
	    "host": "rest-proxy",
	    "url": "http://rest-proxy:4000/example01"
    }
    //...
}</code></pre>
		The above snippet shows 4 services; each having different information configured. Services like Controller, and <b>example01</b> do not need tenant keys to work and that is why <b>extKeyRequired</b> is set to <b>false</b>. Services like <a href='#/documenation/urac'>URAC</a>, and <a href="#/documentation/oauth">oAuth</a> need a <b>tenant key</b> to be accessible so their <b>extKeyRequired</b> is set to <b>true</b>.<br /><br />
		Notice that <b>extKeyRequired</b>, <b>port</b>, <b>url</b> and <b>host</b> are common among all services; these attributes are the default attributes when declaring a service. Other attributes are additional and considered service specific, such as <b>Urac.mail</b>; it tells the service where the templates for email notification are located.<br /><br />
		Every service requires the default attributes to exist so that it can function.
		Based on their business logic, some services  might need additional properties to be provided so they can function, like the <a href='#/documenation/urac'>URAC</a> and Controller shown above.
		These properties are dependent on the running environment.
	</p>

    </p>
    <br />
    <hr/>
    <h4>Details & Code Sample</h4>
    <tabset>
        <tab heading="Details">
            <table class="myTable">
                <thead>
                <tr>
                    <th>Property</th>
                    <th>Type</th>
                    <th>Mandatory</th>
                    <th>Notes</th>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="detail in registry" ng-class="{'first': $first, 'last': $last}" ng-class-odd="'odd'" ng-class-even="'even'">
                    <td width="20%">{{detail.property}}</td>
                    <td>{{detail.type}}</td>
                    <td>{{detail.mandatory}}</td>
                    <td>{{detail.notes}}</td>
                </tr>
                </tbody>
            </table>
        </tab>
        <tab heading="Code Sample">
            <br />
	        <div ng-init="loadCode(path + 'registry/index.js', 'registryjsCode');">
		        <div id="registryjsCode"></div>
	        </div>
            <em>The above snippet is taken from dev.js file which represents the development environment of SOAJS in the registry.</em>
        </tab>
    </tabset>
    <script>renderCodeSnippets();</script>
</div>