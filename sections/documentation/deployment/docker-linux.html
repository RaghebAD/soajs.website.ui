<a id="docker-deployment-linux"></a>
<h1>Docker Deployement on Linux</h1>
<div class="white-container">
	<p>
		Begin by creating the following folder schema so you can place SOAJS Utilities inside it and make sure that <a href="https://docs.docker.com/installation/ubuntulinux/" target="_blank">Docker</a> is installed on the machine you are using.
	</p>
	<pre><code class="bash"># soajs modules go here
$ mkdir -p /opt/soajs/node_modules/</code></pre>
	<hr/>
	<h3>Installation</h3>
	<p>
		SOAJS can be installed on your machine using Docker with little effort needed:
	</p>
	<h4><u>Step1</u></h4>
	<p>
		SOAJS is built using NodeJs and MongoDB therefore, you need to have them installed and running on your machine.
	</p>
	<pre><code class="bash">$ apt-get update

# install NodeJs latest stable version
$ apt-get install nodejs

# install NPM latest stable version
$ apt-get install npm

# install MongoDB latest stable version
$ apt-get install mongodb</code></pre>
	<p>
		Once MongoDB is installed, turn off the service since we only need its tools to perform the import in the below section.
	</p>
	<pre><code class="bash">$ /etc/init.d/mongodb stop</code></pre>
	<p>
		Once NodeJs is installed, install <a target="_blank" href="http://www.npmjs.org/packages/soajs.utilities">soajs.utilities</a> via NPM in /opt/soajs to acquire the configuration files needed to deploy SOAJS.
	</p>
	<pre><code class="bash"># navigate to node_modules
$ cd /opt/soajs/

# install soajs.utilities
$ npm install soajs.utilities</code></pre>
	<p>
		Now install SOAJS and its core services:
	</p>
    <pre><code class="bash">$ cd /opt/soajs/soajs.utilities/lib/

#execute the installer script
$ ./dockerDeploy.sh</code></pre>
    <p>
        The above command will install SOAJS framework and all the core services from NPM then start all the services. You can test each service after the script finishes to check if it is healthy:
    </p>
	<br/>
	<h4><u>Step2</u></h4>
	<p>
		Update the hosts file on your machine and point out the following domains:
	</p>
	<pre><code class="bash">$ gedit /etc/hosts

127.0.0.1   api.soajs.org
127.0.0.1   dashboard-api.soajs.org
127.0.0.1   dashboard.soajs.org</code></pre>
	<p>
		<u><b>Note:</b></u> Make sure you put the correct IP address instead of 127.0.0.1.<br />
		On Linux you can grab the IP address by running this command:
	</p>
	<div ng-init="loadBASH(path + '/deployment/docker/ubuntu-get-ip.tmpl','ubuntuip');"></div>
	<div id="ubuntuip"></div>
	<p>
		Run some heartbeat tests on the services that were installed.
	</p>
	<fieldset>
		<legend>Controller</legend>
		<div>
			<p>
				The controller is the main gateway to SOAJS services and performs awareness and health checks on all the services on a periodic basis.
			</p>
			<div ng-init="loadBASH(path + '/deployment/docker/ubuntu-get-ipcontroller.tmpl','ubuntuipcontroller');"></div>
			<div id="ubuntuipcontroller"></div>
			<p>
				Use the IP retrieved from the command above and Perform a Heartbeat check on the service:
			</p>
			<pre><code class="bash">$ curl -X GET "http://%controller_ip%:5000/heartbeat"</code></pre>
			<p>
				The controller services runs on port 4000 making its maintenance port equal to 5000.
			</p>
			<h5>Response:</h5>
			<pre><code class="bash">{"result":true,"ts":1427373613796,"service":{"service":"CONTROLLER","type":"rest","route":"/heartbeat"}}</code></pre>
		</div>
		<br/>
		<div>
			<p>
				Now reload the registry of the controller:
			</p>
			<pre><code class="bash">$ curl -X GET "http://%controller_ip%:5000/reloadRegistry"</code></pre>
			<p>
				Once the registry is reloaded, the controller will pick up all the running services and which host:port they are using.<br />

			</p>
		</div>
	</fieldset>
	<fieldset>
		<legend>URAC</legend>
		<div>
			<div ng-init="loadBASH(path + '/deployment/docker/ubuntu-get-ipurac.tmpl','ubuntuipurac');"></div>
			<div id="ubuntuipurac"></div>
			<p>
				Use the IP retrieved from the command above and Perform a Heartbeat check on the service:
			</p>
			<pre><code class="bash">$ curl -X GET "http://%urac_ip%:5001/heartbeat"</code></pre>
			<p>
				URAC services runs on port 4001 making its maintenance port equal to 5001 as explained in <a href="#/documentation/core/service">service</a> section under documentation.
			</p>
			<h5>Response:</h5>
			<pre><code class="bash">{"result":true,"ts":1427373613796,"service":{"service":"URAC","type":"rest","route":"/heartbeat"}}</code></pre>
			<em>URAC is healthy ... Great!</em>
		</div>
	</fieldset>
	<!--<fieldset>-->
		<!--<legend>oAuth</legend>-->
		<!--<div>-->
			<!--<div ng-init="loadBASH(path + '/deployment/docker/ubuntu-get-ipoauth.tmpl','ubuntuipoauth');"></div>-->
			<!--<div id="ubuntuipoauth"></div>-->
			<!--<p>-->
				<!--Use the IP retrieved from the command above and Perform a Heartbeat check on the service:-->
			<!--</p>-->
			<!--<pre><code class="bash">$ curl -X GET "http://%oauth_ip%:5002/heartbeat"</code></pre>-->
			<!--<p>-->
				<!--oAuth services runs on port 4002 making its maintenance port equal to 5002.-->
			<!--</p>-->
			<!--<h5>Response:</h5>-->
			<!--<pre><code class="bash">{"result":true,"ts":1427373613796,"service":{"service":"OAUTH","type":"rest","route":"/heartbeat"}}</code></pre>-->
		<!--</div>-->
	<!--</fieldset>-->
	<fieldset>
		<legend>Dashboard</legend>
		<div>
			<p>
				Dashboard contains 2 sections, service and UI. At this stage, we are working with the service and the UI is explained below.
			</p>
			<div ng-init="loadBASH(path + '/deployment/docker/ubuntu-get-ipdashboard.tmpl','ubuntuipdashboard');"></div>
			<div id="ubuntuipdashboard"></div>
			<p>
				Use the IP retrieved from the command above and Perform a Heartbeat check on the service:
			</p>
			<pre><code class="bash">$ curl -X GET "http://%dashboard_ip%:5003/heartbeat"</code></pre>
			<p>
				Dashboard services runs on port 4003 making its maintenance port equal to 5003.
			</p>
			<h5>Response:</h5>
			<pre><code class="bash">{"result":true,"ts":1427373613796,"service":{"service":"DASHBOARD","type":"rest","route":"/heartbeat"}}</code></pre>
		</div>
	</fieldset>
	<h4><u>Step3</u></h4>
	<p>
		Now that all services are checked, let's launch the Dashboard UI, login and start working.
	</p>
	<p>
		The domain dashboard-api.soajs.org redirects requests to the dashboard services which allows you to manage the provisioned information in core database whereas api.soajs.org redirects to the services that only read the provisioned information from the core database.
	</p>
	<p>
		Open your browser and go to <a target="_blank" href="http://dashboard.soajs.org">http://dashboard.soajs.org</a> and login using the administrator account. The administrator account was created with all needed permissions when you imported the provisioned data in the early step. The sample data provides an administrator account with the following credentials:
	</p>
	<b>Owner:</b> ( Full access to all Dashboard services )
	<ul>
		<li><b>Username:</b>&nbsp; owner</li>
		<li><b>Password:</b>&nbsp; password</li>
	</ul>
	<br/>
	<b>Client:</b> ( Limited access to Dashboard services )
	<ul>
		<li><b>Username:</b>&nbsp; client</li>
		<li><b>Password:</b>&nbsp; password</li>
	</ul>
	<p>
		Once you login, you can modify these credentials, monitor the services and perform all core operations related to <a href="#/documentation/advanced/multitenancy">Multitenancy</a>, <a href="#/documentation/advanced/productization">Productization</a>, <a href="#/documentation/advanced/environment">Multi Environment</a> and other. Checkout the <a href="#/documentation/ui/dashboard">Dashboard</a> to see what features are offered.
	</p>
</div>