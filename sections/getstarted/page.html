<div class="page">
	<div class="main-section-container" id="getStartedPage" ng-controller="getStartedCtrl">
		<h1>What is SOAJS?</h1>

		<div class="white-container">
		<p>
			SOAJS refers to Service-Oriented Architecture built using JavaScript.<br />
			Service-Oriented architecture (SOA) is a design pattern in which application components provide services to other components via a communications protocol, typically over a network. The principles of service-orientation are independent of any vendor, product or technology.<br /><br />
			Services can be combined to provide the functionality of a large software application. SOA makes it easier for software components on computers connected over a network to cooperate. Every computer can run any number of services, and each service is built in a way that ensures that the service can exchange information with any other service in the network without human interaction and without the need to make changes to the underlying program itself.<br /><br />
			This makes SOAJS self-aware of all services running in its cloud and can be used to create APIs between the Frontend and Backend of a product without the need of modifying the code of that product.
		</p>
		<hr/>
		<h3>Hello World</h3>
		<p>
			Let's start with a simple "hello world" service that has one API and when called, this API returns two parameters: firstName &amp; lastName in its response.<br />
			This service requires 2 files to function:
		</p>
		<ol>
			<li><b>index.js</b>: contains the code of the service and the API implementation.</li>
			<li><b>config.js</b>: contains the configuration of the service.</li>
		</ol>
		<tabset>
			<tab heading="index.js">
				<pre><code class="javascript">'use strict';
var soajs = require('soajs');
var config = require('./config.js');
var service = new soajs.server.service({ "config": config });
service.init(function () {
	service.get("/hello", function (req, res) {
		res.json(req.soajs.buildResponse(null, "Hello "+req.soajs.inputmaskData.firstName+" "+req.soajs.inputmaskData.lastName));
	});
	service.start();
});</code></pre>
			</tab>
			<tab heading="config.js">
				<pre><code class="javascript">module.exports = {
	serviceName: "helloworld",
	servicePort: 4020,
	extKeyRequired: false,
	"errors": {},
	"schema": {
		"/hello": {
			"_apiInfo":{
				"l": "hello world"
			},
			"firstName": {
				"source": ['query.firstName'],
				"required": true,
				"validation": {
					"type": "string"
				}
			},
			"lastName": {
				"source": ['query.lastName'],
				"required": true,
				"validation": {
					"type": "string"
				}
			}
		}
	}
};</code></pre>
			</tab>
		</tabset>
		<p>
			Simply create the service using SOAJS service constructor, pass along the configuration, initialize it and start implementing the APIs.<br />
			SOAJS is equiped with tons of features:
		</p>
		<ul>
			<li>
				<b>soajs.server.service</b>: used to declare a new service with SOAJS and requires the service configuration as a param.<br />
				More information on what configuration can be provided is explained in <a href="#/documentation/core/service">Service</a> section under documentation.
			</li>
			<li>
				<b>req.soajs.inputmaskData</b>: maps, validates, and format all the inputs arriving to the API.<br />
				IMFV also consolidates all these inputs regardless of the source they arrive from into one object: <b>inputmaskData</b>.<br />
				For additional information, check out <a href=#/documenation/core/imfv>IMFV</a> section under documentation.
			</li>
			<li>
				<b>buildResponse</b>: used to build a standardized JSON response regardless of the data returned by your API.<br />
			</li>
		</ul>
		<p>Now that you have an idea what a service looks like, let's run it and invoke its APIs.</p>
		<hr/>
		<h3>Start the service</h3>
		<p>
			Before you run your service, make sure you have the following technologies installed:<br />
			- <a href="http://www.mongodb.org" target="_blank">MongoDB</a> ( version 2.6.7 or higher)<br />
			- <a href="http://www.nodejs.org" target="_blank">NodeJS</a> (version 0.10.25 or higher)
		</p>
		<p>
			Next, download the "hello world" service by installing <a href="https://npmjs.org/packages/soajs.examples" target="_blank">soajs.examples</a> and <a href="https://npmjs.org/packages/soajs.utilities" target="_blank">soajs.utilities</a> modules:
		</p>
		<pre><code class="bash"># create a directory to place your soajs modules in
$ mkdir -p /opt/soajs/node_modules/
$ cd /opt/soajs/node_modules/

# install the examples in that directory
$ npm install soajs.examples

# install the utilities in that directory
$ npm install soajs.utilities</code></pre>
		<p>
			We have provided a simple "hello world" service in soajs.examples module to get you started quickly.<br />
			We also configured the "hello world" service to be registered in the database and placed that configuration in a file in soajs.utilities.<br />
			That is why you need to install both these modules using npm, and import the sample configuration from soajs.utilities.<br />
			We explain the configuration in later steps, but for now we want to show you how get things running with SOAJS.<br />
			Once these two modules are installed on your machine, import some test data into the database, and start the service.
		</p>
		<pre><code class="bash"># import some test data from utilities
$ cd soajs.utilities/lib
$ node index.js data import provision

# go to examples/hello_world and start the service
$ cd ../../soajs.examples/hello_world/
$ node .</code></pre>
		<hr/>
		<h3>Test the service</h3>
		<p>
			Once the service starts, run the following curl command that calls the API of your "hello world" service:
		</p>
		<pre><code class="bash">$ CURL -X GET "http://127.0.0.1:4020/hello?firstName=John&lastName=Doe"</code></pre>
		<p>The service will reply with a json response:</p>
		<pre><code class="javascript">{
	"result": true,
	"data": "Hello John Doe"
}</code></pre>
		<em>That's it!</em>
		<hr/>
		<h3>Protect the service</h3>
		<p>
			Now that you have seen how to run and call your service, let's protect it.<br />
			First, stop the service from your terminal, then edit the index.js file. On the third line next to <b>"config":config</b> add <b>"oauth": true</b>.<br />
		</p>
		<pre><code class="javascript">var service = new soajs.server.service({ "config": config, "oauth": true });</code></pre>
		<p>
			Enabling oAuth secures your service, any unauthorized request made to its APIs will be rejected.<br />
			Turn your service back on and hit the API a second time:
		</p>
		<pre><code class="bash"># turn the service back on
$ node .

# hit the same API again
$ CURL -X GET "http://127.0.0.1:4020/hello?firstName=John&lastName=Doe"</code></pre>
		<h5>Response:</h5>
		<pre><code class="javascript">{
	result: false,
	errors: {
		codes: [ 400 ],
		details: [ { code: 400, message: "The access token was not found" } ]
	}
}</code></pre>
		<em>I told you it's protected!</em>
		<p>
			In order to access your service API, you need to login to oAuth, acquire an <b>access_token</b> and add it in your request.<br />
			First install <a href="https://npmjs.org/packages/soajs.oauth" target="_blank">soajs.oauth</a> module and run it:
		</p>
		<pre><code class="bash">$ cd /opt/soajs/node_modules/
$ npm install soajs.oauth

# navigate to soajs.oauth and start the service
$ cd soajs.oauth
$ node .</code></pre>
		<p>
			SOAJS oauth runs on port 4002, so let's login using the following curl command:
		</p>
		<pre><code class="bash">$ CURL -X POST -H "Authorization: Basic MTBkMmNiNWZjMDRjZTUxZTA2MDAwMDAxOnNoaGggdGhpcyBpcyBhIHNlY3JldA==" -H "key:aa39b5490c4a4ed0e56d7ec1232a428f771e8bb83cfcee16de14f735d0f5da587d5968ec4f785e38570902fd24e0b522b46cb171872d1ea038e88328e7d973ff47d9392f72b2d49566209eb88eb60aed8534a965cf30072c39565bd8d72f68ac" "http://127.0.0.1:4002/token" -d 'username=oauthuser&password=oauthpassword&grant_type=password'</code></pre>
		<h5>Response:</h5>
		<pre><code class="javascript">{
	"token_type": "bearer",
	"access_token": "e58751473112bca2ed939e0445e55b0f7921f544",
	"expires_in": 3600,
	"refresh_token": "bb09a2f5582425c4ef9440dcce5885cbbe743047"
}</code></pre>
		<p>
			Grab the access token from the response returned and add it in the next request u will make to "hello world" API:
		</p>
		<pre><code class="bash">http://127.0.0.1:4020/hello?firstName=John&lastName=Doe&access_token=e58751473112bca2ed939e0445e55b0f7921f544</code></pre>
		<h5>Response:</h5>
		<pre><code class="javascript">{
	"result": true,
	"data": "Hello John Doe"
}</code></pre>
		<em>Working again!</em>
		<p>
			You can protect any service you want using oAuth. As you have seen, 4 basic steps are required:
		</p>
		<ol>
			<li>install soajs.oauth and turn it on</li>
			<li>login to soajs.oauth and get an access_token</li>
			<li>add the access_token to your request</li>
		</ol>
		<p>
			If you want to know more about service protection via oAuth, check out the <a href="#/documenation/oauth">oAuth</a> section under documenation.<br />
			Now let's head on to the Step 2 and Checkout the examples that where downloaded when we installed <b>soajs.examples</b>.
		</p>
		<div style="clear:both; display: table; width: 100%;">
			<a class="small-button" href="#/getStarted/example01">Next &raquo;</a>
		</div>
	</div>
	<script>renderCodeSnippets();</script>
	</div>
</div>