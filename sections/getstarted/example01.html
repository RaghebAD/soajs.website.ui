<div class="page" ng-controller="getStartedCtrl">
	<div id="example01" class="main-section-container examples">
		<a href="#/getStarted" class="goBackLink">Go Back</a>
		<a id="top"></a><h1>Example 01</h1>
		<div class="white-container">
		<p>
			In this example we will create a simple service that provides some APIs that use different protocols: GET - POST - PUT - DEL.<br/>
			The example focuses on how to make use of <a href="#/documentation/core/imfv">IMFV</a> that facilitates fetching and validation of the parameters passed to an API.<br/>
			The service "<b>Example01</b>" will be public and will not be secured and accessible by everyone.<br/>
			The service is split up into 2 files:
		</p>
		<ol>
			<li><b>index.js</b>: contains the code of the service that implements the APIs.</li>
			<li><b>config.js</b>: contains the configuration used by.<a href='#/documentation/core/imfv'>IMFV</a>.</li>
		</ol>
		<p>
			<b>Example01</b> is located in soajs.examples module and since we installed this module in the previous section, all we need to do now is simply turn it on.
		</p>
		<hr/>
		<h3>Start the service</h3>
		<p>
			Start the service by navigating to soajs.examples/example01 and run the below command, just like you did in "hello world".
		</p>
		<pre><code class="bash"># navigate to soajs.examples/example01 service and start it
$ cd soajs.examples/example01/
$ node .</code></pre>
		<p>
			<b>Example01</b> is now running on http://127.0.0.1:4010.<br />
			Let's do a heartbeat check just to make sure all is working as expected before we begin the tests.<br /><br />
		</p>
		<fieldset>
			<legend>Heartbeat Example01</legend>
			<div class="insideFieldsetMain">
				<div>
					<pre><code class="bash">$ curl -X GET "http://127.0.0.1:5010/heartbeat"</code></pre>
					<h6><u>Response:</u></h6>
					<pre><code class="bash">{
	"result":true,
	"ts":1425054123486,
	"service": {
		"service":"example01",
		"type":"rest",
		"route":"/heartbeat"
	}
}</code></pre>
					<p>
						A heartbeat test tells us if a service is healthy or not. Every service running listens to 2 ports: default and maintenance.<br />
						Example01 runs on port 4010, its maintenance port is equal to defaul port number + 1000 which means 5010.<br />
						Perform a heartbeat test on any service by providing it's maintenance port followed by <b>/heartbeat</b> route.
					</p>
				</div>
			</div>
		</fieldset>
		<hr/>
		<h3>Running Some Tests</h3>
		<p>
			<b>Example01</b> services is running, so let's start some tests on its APIs and see what happens.<br/>
			Before we begin the tests, note that we have configured Example01 APIs to look for the following fields:
		</p>
		<table class="myTable" width="100%">
			<thead>
				<tr>
					<th>Parameter</th>
					<th>Mandatory</th>
					<th>Type</th>
					<th>Source</th>
					<th>Format</th>
				</tr>
			</thead>
			<tbod>
				<tr>
					<td>firstName</td>
					<td>YES</td>
					<td>String</td>
					<td>Query String</td>
					<td>N/A</td>
				</tr>
				<tr class="even">
					<td>lastName</td>
					<td>YES</td>
					<td>String</td>
					<td>Query String</td>
					<td>N/A</td>
				</tr>
				<tr>
					<td>email</td>
					<td>NO</td>
					<td>String</td>
					<td>Query String</td>
					<td>Email Only.</td>
				</tr>
			</tbod>
		</table>
		<br/>
		<fieldset>
			<legend><b>/testGet api: Fail</b></legend>
			<div class="insideFieldsetMain">
				<div>
					<pre><code class="bash">$ curl -X GET "http://127.0.0.1:4000/example01/testGet?firstName=John" </code> </pre>
					<h6>Response</h6>
					<div ng-init="loadJSON(path + 'example01/result01.json', 'result01');">
						<div id="result01"></div>
					</div>
					<br/>
					<p>
						The API returned a false response because when we triggered the call, we did not specify a <b>lastName</b> in the querystring and we configured this API to read this parameter and make sure it is provided. <a href='#/documentation/core/imfv'>IMFV</a> did not find <b>lastName</b> in the parameters and thus stopped the request from continuing and returned an error message back to us.
					</p>
				</div>
			</div>
		</fieldset>
		<fieldset>
			<legend><b>/testGet api: Success</b></legend><div class="insideFieldsetMain">
			<div>
				<pre><code class="bash">$ curl -X GET "http://127.0.0.1:4000/example01/testGet?firstName=John&lastName=Smith&email=john@smith.com" </code> </pre>
				<h6>Response</h6>

				<div ng-init="loadJSON(path + 'example01/result02.json', 'result02');">
					<div id="result02"></div>
				</div><br />
				<p>This time the API returned a valid response with the JSON Object containing all the parameters we specified.</p>
			</div></div>
		</fieldset>
		<fieldset>
			<legend><b>/testPost api: Success</b></legend><div class="insideFieldsetMain">
			<div>
				<p>
					This API is exactly like testGet but uses post as a protocol.
				</p>
				<pre><code class="bash">$ curl -X POST -H "Content-type:application/json" -H "Accept:application/json" "http://127.0.0.1:4000/example01/testPost" -d '{"firstName":"John","lastName":"Smith"}'</code> </pre>
				<h6>Response</h6>

				<div ng-init="loadJSON(path + 'example01/testPost1.json', 'testPost1');">
					<div id="testPost1"></div>
				</div>
			</div></div>
		</fieldset>
		<fieldset>
			<legend><b>/testPost api: Success</b></legend><div class="insideFieldsetMain">
			<div>
				<p>

				</p>
				<pre><code class="bash">$ curl -X POST -H "Content-type:application/json" -H "Accept:application/json" "http://127.0.0.1:4000/example01/testPost" -d '{"firstName":"John","lastName":"Smith","email":"john@smith.com"}'</code></pre>
				<h6>Response</h6>

				<div ng-init="loadJSON(path + 'example01/testPost2.json', 'testPost2');">
					<div id="testPost2"></div>
				</div>
			</div></div>
		</fieldset>
		<fieldset>
			<legend><b>/testPost api: Fail</b></legend><div class="insideFieldsetMain">
			<div>
				<p>
					This API resemble the first two above with one difference, the value of <b>firstName</b> should be only <b>John</b>.
				</p>
				<pre><code class="bash">$ curl -X POST -H "Content-type:application/json" -H "Accept:application/json" "http://127.0.0.1:4000/example01/testPost" -d '{"firstName":"Johnx","lastName":"Smith"}'</code></pre>

				<h6>Response</h6>

				<div ng-init="loadJSON(path + 'example01/testPost3.json', 'testPost3');">
					<div id="testPost3"></div>
				</div>
				<br/>
				<p>
					This test failed because not only do we need to provide a <b>firstName</b> parameter when calling this API, but we also need to make sure that the value is always equal to "John".
				</p>
			</div></div>
		</fieldset>
		<fieldset>
			<legend><b>/testPut api: Success Test</b></legend><div class="insideFieldsetMain">
			<div>
				<p>
					SOAJS also provides support for PUT and DEL protocols not just GET and POST.
				</p>
				<pre><code class="bash">$ curl -X PUT -H "Content-type:application/json" -H "Accept:application/json" "http://127.0.0.1:4000/example01/testPut" -d '{"firstName":"John","lastName":"Smith"}'</code></pre>
				<h6>Response</h6>

				<div ng-init="loadJSON(path + 'example01/testPut1.json', 'testPut1');">
					<div id="testPut1"></div>
				</div>
			</div></div>
		</fieldset>
		<fieldset>
			<legend><b>/testDel api: Success</b></legend><div class="insideFieldsetMain">
			<div>
				<pre><code class="bash">$ curl -X DELETE "http://127.0.0.1:4000/example01/testDel?firstName=John&lastName=Smith"</code></pre>
				<h6>Response</h6>

				<div ng-init="loadJSON(path + 'example01/testDel1.json', 'testDel1');">
					<div id="testDel1"></div>
				</div>
			</div></div>
		</fieldset>
		<fieldset>
			<legend><b>/buildName api: Success</b></legend><div class="insideFieldsetMain">
			<div>
				<pre><code class="bash">$ curl -X GET "http://127.0.0.1:4000/example01/buildName?firstName=James&lastName=Smith"</code></pre>
				<h6>Response</h6>
				<div ng-init="loadJSON(path + 'example01/buildName1.json', 'buildName1');">
					<div id="buildName1"></div>
				</div>
			</div></div>
		</fieldset>
		<fieldset><legend><b>/buildName api: Test 2</b></legend>
			<div class="insideFieldsetMain">
				<div>
					<pre><code class="bash">$ curl -X GET "http://127.0.0.1:4000/example01/buildName?lastName=Smith"</code></pre>

					<h6>Response</h6>

					<div ng-init="loadJSON(path + 'example01/buildName2.json', 'buildName2');">
						<div id="buildName2"></div>
					</div>
					<br/>
					<p>
						This API returned a success response even though <b>firstName</b> was not provided as a parameter.<br />
						We previously configured this api to use a default value for firstName if it is not provided in the parameters.<br />
						In the previous test, we made a call and specified <b>firstName</b> to be "<b>James</b>" and the returned response was "<b>James Smith</b>" but here we only provided the <b>lastName</b> as a parameter and since the default value configured for the <b>firstName</b> input is "John", <a href="#/documentation/core/imfv">IMFV</a> used that value instead of throwing an error saying missing parameters.
					</p>
				</div></div>
		</fieldset>
		<hr/>
		<h3>Code Explanation</h3>
		<p>
			<b>Example01</b> has 5 APIs, these APIs are defined in <u>index.js</u> and each API has a representation in <u>config.js</u> to enable its <a href='#/documentation/core/imfv'>IMFV</a> configuration.<br />
			IMFV maps, validates and format all inputs arriving to an API, then consodlidates them all in <b>req.soajs.inputmaskData</b> object.<br />
			IMFV checks for mandatory inputs and supports default values for non-provided inputs if instructed to.<br />
			You can learn more on what IMFV supports and how it works in section <a href='#/documentation/core/imfv'>IMFV</a> under documenation.<br /><br />
			The below snippets represent the content of both <b>index.js</b> and <b>config.js</b> that make up <b>Example01</b> services. Each API implemented in index.js reads the inputs received, formulates a JSON response and returns it. The schema in config.js elaborates what each API should receive as inputs, if they are mandatory, use default values and what type they should be.
		</p>
		<br />
		<tabset>
			<tab heading="index.js">
				<br/>
				<div ng-init="loadCode(path + 'example01/index.js', 'indexjs');"></div>
				<div id="indexjs"></div>
			</tab>
			<tab heading="config.js">
				<br/>
				<div ng-init="loadCode(path + 'example01/config.js', 'configjs');"></div>
				<div id="configjs"></div>
			</tab>
		</tabset>
		<hr/>
		<p>
			By now you have seen how easy it is to configure <a href='#/documentation/core/imfv'>IMFV</a> for a service, how quick and simple it is to write an API service and how to perform maintenance operations on a service. Imagine how much time and effort you have saved just by creating two files and a few lines of code in each of them.<br />
			Try to conduct additional tests and scenarios on <b>Example01</b> APIs. When you are ready to jump to the next level.
		</p>
		<div style="clear:both; width:100%; display: table;">
			<a class="small-button" href="#/getStarted/example02">Next &raquo;</a>
		</div>
		</div>
		<script>renderCodeSnippets();</script>
	</div>
</div>